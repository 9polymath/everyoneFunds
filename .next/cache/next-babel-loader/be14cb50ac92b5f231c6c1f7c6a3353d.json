{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Layout from '../../components/Layout';\nimport Campaign from \"../../ethereum/Campaign\";\nimport { Card, Grid, Button, Message, Form, Progress } from 'semantic-ui-react';\nimport web3 from '../../ethereum/web3';\nimport ContributeForm from '../../components/ContributeForm';\nimport { Link, Router } from '../../routes';\nimport everyoneFunds from \"../../ethereum/everyoneFunds\";\n\nvar CampaignShow = /*#__PURE__*/function (_Component) {\n  _inherits(CampaignShow, _Component);\n\n  var _super = _createSuper(CampaignShow);\n\n  function CampaignShow() {\n    var _this;\n\n    _classCallCheck(this, CampaignShow);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      errorMessage: '',\n      loading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClick\", /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var address, accounts;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                _this.setState({\n                  loading: true,\n                  errorMessage: ''\n                });\n\n                address = Campaign(_this.props.address);\n                _context.prev = 3;\n                _context.next = 6;\n                return web3.eth.getAccounts();\n\n              case 6:\n                accounts = _context.sent;\n                _context.next = 9;\n                return address.methods.endCrowdfunding().send({\n                  from: accounts[0]\n                });\n\n              case 9:\n                _context.next = 11;\n                return everyoneFunds.methods.removeDeployedCampaign().send({\n                  from: accounts[0]\n                });\n\n              case 11:\n                Router.pushRoute('/');\n                _context.next = 17;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](3);\n\n                _this.setState({\n                  errorMessage: _context.t0.message\n                });\n\n              case 17:\n                _this.setState({\n                  loading: false\n                });\n\n              case 18:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 14]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(CampaignShow, [{\n    key: \"renderCards\",\n    value: function renderCards() {\n      var _this$props = this.props,\n          balance = _this$props.balance,\n          manager = _this$props.manager,\n          minimumDonation = _this$props.minimumDonation,\n          targetDonation = _this$props.targetDonation,\n          requestCount = _this$props.requestCount,\n          approversCount = _this$props.approversCount;\n      var items = [{\n        header: manager,\n        meta: 'Address of Manager',\n        description: 'The manager created this campaign and can create requests to withdraw money',\n        style: {\n          overflowWrap: 'break-word'\n        }\n      }, {\n        header: minimumDonation,\n        meta: 'Minimum Donation (wei)',\n        description: 'You must donate at least this much wei to become an approver'\n      }, {\n        header: web3.utils.fromWei(targetDonation, 'ether'),\n        meta: 'Target Donation (ether)',\n        description: 'This is how much the campaign manager intends to raise with this campaign.'\n      }, {\n        header: requestCount,\n        meta: 'Number of Requests',\n        description: 'A request tries to withdraw money from this contract. Requests must be approved by approvers'\n      }, {\n        header: approversCount,\n        meta: 'Number of Approvers',\n        description: 'Number of people that have donated to this contract.'\n      }, {\n        header: web3.utils.fromWei(balance, 'ether'),\n        meta: 'Campaign Balance (ether)',\n        description: 'The balance is how much money this campaign has left to spend'\n      }];\n      return __jsx(Card.Group, {\n        items: items\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          name = _this$props2.name,\n          description = _this$props2.description,\n          media = _this$props2.media,\n          location = _this$props2.location,\n          date = _this$props2.date,\n          links = _this$props2.links;\n      return __jsx(Layout, null, __jsx(\"h4\", null, \" Campaign Details\"), __jsx(\"h2\", null, \" \", name), __jsx(\"p\", null, \" \", description), __jsx(\"p\", null, media), __jsx(Grid, null, __jsx(Grid.Row, null, __jsx(Grid.Column, {\n        width: 10\n      }, this.renderCards()), __jsx(Grid.Column, {\n        width: 6\n      }, __jsx(ContributeForm, {\n        address: this.props.address\n      }), __jsx(\"p\", null, location), __jsx(\"p\", null, date), __jsx(\"p\", null, links))), __jsx(Grid.Row, null, __jsx(Grid.Column, {\n        width: 6\n      }, __jsx(Link, {\n        route: \"/campaigns/\".concat(this.props.address, \"/requests\")\n      }, __jsx(\"a\", null, __jsx(Button, {\n        primary: true\n      }, \"View Requests\")))), __jsx(Grid.Column, {\n        width: 9\n      }, __jsx(Button, {\n        onClick: this.onClick,\n        loading: this.state.loading,\n        error: !!this.state.errorMessage,\n        negative: true\n      }, \"End Campaign\")))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(props) {\n        var campaign, summary, data;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                campaign = Campaign(props.query.address);\n                _context2.next = 3;\n                return campaign.methods.getSummary().call();\n\n              case 3:\n                summary = _context2.sent;\n                data = this.state.data.data;\n                return _context2.abrupt(\"return\", {\n                  address: props.query.address,\n                  minimumDonation: summary[0],\n                  targetDonation: summary[1],\n                  balance: summary[2],\n                  requestCount: summary[3],\n                  approversCount: summary[4],\n                  manager: summary[5],\n                  data: data\n                });\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getInitialProps(_x2) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return CampaignShow;\n}(Component);\n\nexport default CampaignShow;","map":{"version":3,"sources":["/Users/dolapoolaniawo/Desktop/noin/pages/campaigns/show.js"],"names":["React","Component","Layout","Campaign","Card","Grid","Button","Message","Form","Progress","web3","ContributeForm","Link","Router","everyoneFunds","CampaignShow","errorMessage","loading","event","preventDefault","setState","address","props","eth","getAccounts","accounts","methods","endCrowdfunding","send","from","removeDeployedCampaign","pushRoute","message","balance","manager","minimumDonation","targetDonation","requestCount","approversCount","items","header","meta","description","style","overflowWrap","utils","fromWei","name","media","location","date","links","renderCards","onClick","state","campaign","query","getSummary","call","summary","data"],"mappings":"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","sourcesContent":["import React, { Component }from 'react';\nimport Layout from '../../components/Layout';\nimport Campaign from \"../../ethereum/Campaign\";\nimport {Card, Grid, Button, Message, Form, Progress} from 'semantic-ui-react';\nimport web3 from '../../ethereum/web3';\nimport ContributeForm from '../../components/ContributeForm';\nimport {Link, Router} from '../../routes';\nimport everyoneFunds from \"../../ethereum/everyoneFunds\";\n\nclass CampaignShow extends Component {\n    state={\n        errorMessage: '',\n        loading: false\n    };\n    static async getInitialProps(props){\n        const campaign = Campaign(props.query.address);\n        const summary =  await campaign.methods.getSummary().call();\n        const {data} = this.state.data;\n        return {\n            address: props.query.address,\n            minimumDonation: summary[0],\n            targetDonation: summary[1],\n            balance: summary[2],\n            requestCount: summary[3],\n            approversCount: summary[4],\n            manager: summary[5],\n            data: data\n        };\n    }\n    onClick = async (event) => {\n        event.preventDefault();\n        this.setState({loading:true, errorMessage: ''});\n        const address = Campaign(this.props.address);\n\n        try {\n            const accounts = await web3.eth.getAccounts();\n            await address.methods\n                .endCrowdfunding()\n                .send({\n                    from: accounts[0]\n                });\n            await everyoneFunds.methods.removeDeployedCampaign().send({from: accounts[0]});\n            Router.pushRoute('/');\n        } catch (err) {\n            this.setState({errorMessage: err.message});\n        }\n        this.setState({loading:false});\n    };\n    renderCards(){\n        const {\n            balance,\n            manager,\n            minimumDonation,\n            targetDonation,\n            requestCount,\n            approversCount\n        } = this.props;\n        const items = [\n\n            {\n                header: manager,\n                meta: 'Address of Manager',\n            description: 'The manager created this campaign and can create requests to withdraw money',\n            style: {overflowWrap: 'break-word'}\n            },\n            {\n                header: minimumDonation,\n                meta: 'Minimum Donation (wei)',\n            description: 'You must donate at least this much wei to become an approver'\n            },\n            {\n                header: web3.utils.fromWei(targetDonation, 'ether'),\n                meta: 'Target Donation (ether)',\n            description: 'This is how much the campaign manager intends to raise with this campaign.'\n            },\n            {\n                header: requestCount,\n                meta: 'Number of Requests',\n            description: 'A request tries to withdraw money from this contract. Requests must be approved by approvers'\n            },\n            {\n                header: approversCount,\n                meta: 'Number of Approvers',\n            description: 'Number of people that have donated to this contract.'\n            },\n            {\n                header: web3.utils.fromWei(balance, 'ether'),\n                meta: 'Campaign Balance (ether)',\n            description: 'The balance is how much money this campaign has left to spend'\n            }\n\n        ];\n        return <Card.Group items={items}/>\n    }\n    render() {\n        const {name,description, media, location, date, links} = this.props;\n        return (\n            <Layout>\n                <h4> Campaign Details</h4>\n                <h2> {name}</h2>\n                <p> {description}</p>\n                <p>{media}</p>\n                <Grid>\n                    <Grid.Row>\n                        <Grid.Column width={10}>\n                            {this.renderCards()}\n                        </Grid.Column>\n                        <Grid.Column width={6}>\n                            <ContributeForm address={this.props.address}/>\n                            <p>{location}</p>\n                            <p>{date}</p>\n                            <p>{links}</p>\n                        </Grid.Column>\n                    </Grid.Row>\n                    <Grid.Row>\n                        <Grid.Column width={6}>\n                            <Link route={`/campaigns/${this.props.address}/requests`}>\n                                <a>\n                                    <Button primary>View Requests</Button>\n                                </a>\n                            </Link>\n                        </Grid.Column>\n                        <Grid.Column width={9}>\n                            <Button onClick = {this.onClick} loading={this.state.loading} error={!!this.state.errorMessage} negative>End Campaign</Button>\n                        </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </Layout>\n        );\n    }\n}\n\nexport default CampaignShow;\n"]},"metadata":{},"sourceType":"module"}